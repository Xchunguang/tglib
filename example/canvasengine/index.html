<!DOCTYPE html>
<html>

<body>
  <div id="main">
    <canvas id="canvas"></canvas>
  </div>

  <script src="../../dist/tglib.umd.js"></script>
  <script>
    let template = `<view id="container"><text id="testText" class="redText" value="hello canvas"></text></view>`
    let style = {
      container: {
          width: 200,
          height: 100,
          backgroundColor: '#ccc',
          justContent: 'center',
          alignItems: 'center',
          borderRadius: 50,
          borderColor: 'red',
          borderWidth: 0,
          marginTop: 30,
          marginLeft: 30,
      },
      testText: {
          color: '#ffffff',
          width: 200,
          height: 50,
          lineHeight: 100,
          fontSize: 25,
          textAlign: 'center',
      },
      // 文字的最终颜色为#ff0000
      redText: {
          color: '#ff0000',
      }
  }
  let Layout = tglib.Layout.default;
  let canvas = document.getElementById('canvas');
  let context = canvas.getContext('2d');

  // 设置canvas的尺寸和样式的container比例一致
  canvas.style.width = 200 + 'px';
  canvas.style.height = 100 + 'px';
  canvas.width = 400;
  canvas.height = 200;
  function getElementPagePosition(element) {
      //计算x坐标
      var actualLeft = element.offsetLeft;
      var current = element.offsetParent;
      while (current !== null) {
        actualLeft += current.offsetLeft;
        current = current.offsetParent;
      }
      //计算y坐标
      var actualTop = element.offsetTop;
      var current = element.offsetParent;
      while (current !== null) {
        actualTop += (current.offsetTop + current.clientTop);
        current = current.offsetParent;
      }
      //返回结果
      return { x: actualLeft, y: actualTop }
    }
  let pos = getElementPagePosition(canvas);
  Layout.init(template, style);
  Layout.updateViewPort({
        x: pos.x,
        y: pos.y,
        width: canvas.offsetWidth,
        height: canvas.offsetHeight,
  });
  Layout.layout(context);

  const con = Layout.getElementsById('testText');
  let textView = con[0];
  textView.on('click', (e)=>console.log(e))
  </script>
</body>

</html>
